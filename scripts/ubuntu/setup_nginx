# !/usr/bin/env bash
# -*- coding: utf-8 -*-

NGINX_CONFIG_FILE=./nginx_minecraft.conf
NGINX_CONFIG_FILE_NAME=$(basename ${NGINX_CONFIG_FILE})
NGINX_SITE_AVAILABLE_FILE_PATH="/etc/nginx/sites-available/${NGINX_CONFIG_FILE_NAME}"
NGINX_SITE_ENABLE_FILE_PATH="/etc/nginx/sites-enabled/${NGINX_CONFIG_FILE_NAME}"
if [ -f "$NGINX_SITE_AVAILABLE_FILE_PATH" ]; then
    sudo rm -f $NGINX_SITE_AVAILABLE_FILE_PATH $NGINX_SITE_ENABLE_FILE_PATH
fi
sudo cp $NGINX_CONFIG_FILE $NGINX_SITE_AVAILABLE_FILE_PATH && \
sudo ln -s $NGINX_SITE_AVAILABLE_FILE_PATH $NGINX_SITE_ENABLE_FILE_PATH
# check nginx config validation and reload nginx to make server config take effect
sudo nginx -t && sudo systemctl reload nginx && echo setup_nginx success!
